name: ğŸ”§ ØªØ¬Ø±Ø¨Ø© Ø¨Ù„ÙˆØ¬Ø± Ø§Ù„Ø¨Ø³ÙŠØ·Ø©

on:
  workflow_dispatch:  # ØªØ´ØºÙŠÙ„ ÙŠØ¯ÙˆÙŠ ÙÙ‚Ø·

jobs:
  test-blogger:
    runs-on: ubuntu-latest
    
    steps:
      # 1. ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
      - name: â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
        uses: actions/checkout@v3
      
      # 2. Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨Ø§ÙŠØ«ÙˆÙ†
      - name: ğŸ Ø¥Ø¹Ø¯Ø§Ø¯ Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      # 3. ØªØ«Ø¨ÙŠØª Ù…ÙƒØªØ¨Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª requests
        run: pip install requests
      
      # 4. ÙƒÙˆØ¯ Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¨Ø³ÙŠØ·
      - name: ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
        env:
          BLOG_ID: ${{ secrets.BLOG_ID }}
          API_KEY: ${{ secrets.API_KEY }}
        run: |
          # ÙƒÙˆØ¯ Ø¨Ø§ÙŠØ«ÙˆÙ† Ø¨Ø³ÙŠØ· Ù„Ù„ØªØ¬Ø±Ø¨Ø©
          cat > test.py << 'EOF'
import os
import requests
import json

blog_id = os.getenv('BLOG_ID')
api_key = os.getenv('API_KEY')

print("="*50)
print("ğŸ” Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±")
print("="*50)

# 1. Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
print(f"ğŸ“Œ BLOG_ID: {'âœ… Ù…ÙˆØ¬ÙˆØ¯' if blog_id else 'âŒ Ù…ÙÙ‚ÙˆØ¯'}")
print(f"ğŸ“Œ API_KEY: {'âœ… Ù…ÙˆØ¬ÙˆØ¯' if api_key else 'âŒ Ù…ÙÙ‚ÙˆØ¯'}")

if not blog_id or not api_key:
    print("\nâŒ Ø§ØªØ¨Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ§Øª:")
    print("1. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Settings > Secrets > Actions")
    print("2. Ø£Ø¶Ù Secret Ø¬Ø¯ÙŠØ¯:")
    print("   - Name: BLOG_ID")
    print("   - Value: 1234567890123456789")
    print("3. Ø£Ø¶Ù Secret Ø¬Ø¯ÙŠØ¯:")
    print("   - Name: API_KEY")
    print("   - Value: AIzaSyB... (Ù…ÙØªØ§Ø­ API Ù…Ù† Google Cloud)")
    exit(1)

# 2. Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©
try:
    print("\nğŸŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¨Ù„ÙˆØ¬Ø± API...")
    
    url = f"https://www.googleapis.com/blogger/v3/blogs/{blog_id}?key={api_key}"
    response = requests.get(url, timeout=10)
    
    print(f"ğŸ“¡ Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„: {response.status_code}")
    
    if response.status_code == 200:
        data = response.json()
        print("\nğŸ‰ Ù†Ø¬Ø§Ø­ Ø§Ù„Ø§ØªØµØ§Ù„!")
        print(f"ğŸ“ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©: {data.get('name', 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ')}")
        print(f"ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©: {data.get('url', 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ')}")
        print(f"ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: {data.get('published', 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ')}")
        
        # Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª
        posts_url = f"https://www.googleapis.com/blogger/v3/blogs/{blog_id}/posts?key={api_key}&maxResults=3"
        posts_response = requests.get(posts_url)
        
        if posts_response.status_code == 200:
            posts_data = posts_response.json()
            print(f"\nğŸ“° Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª: {posts_data.get('totalItems', 0)}")
            
            if 'items' in posts_data:
                print("ğŸ“‹ Ø¢Ø®Ø± 3 Ù…Ù†Ø´ÙˆØ±Ø§Øª:")
                for i, post in enumerate(posts_data['items'], 1):
                    status = "Ù…Ø³ÙˆØ¯Ø©" if post.get('status') == 'DRAFT' else "Ù…Ù†Ø´ÙˆØ±"
                    print(f"  {i}. {post['title']} ({status})")
        else:
            print("âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª")
            
    elif response.status_code == 403:
        print("\nğŸ” Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµØ±ÙŠØ­:")
        print("1. ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Blogger API")
        print("2. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© API Key")
        print("3. ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ‚ÙŠÙŠØ¯ API Key Ø¹Ù„Ù‰ Blogger API ÙÙ‚Ø·")
    elif response.status_code == 404:
        print("\nğŸ” Ø§Ù„Ù…Ø¯ÙˆÙ†Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©")
        print("ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© BLOG_ID")
    else:
        print(f"\nâš ï¸ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹: {response.text[:100]}")
        
except requests.exceptions.Timeout:
    print("\nâ° Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„")
except requests.exceptions.RequestException as e:
    print(f"\nâŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: {e}")
except Exception as e:
    print(f"\nâš ï¸ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹: {e}")

print("\n" + "="*50)
print("âœ… Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±")
print("="*50)
EOF

          # ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
          python test.py
