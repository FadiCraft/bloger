name: BLOGGER

on:
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - name: โ ุงูุชุญูู ูู ุงููุธุงู
        run: |
          echo "=== ุงููุธุงู ูุนูู ==="
          echo "๐ ุงูููุช: $(date)"
          echo "๐ Python: $(python3 --version || echo 'ุบูุฑ ูุซุจุช')"
          echo "๐ ุงููููุงุช:"
          ls -la
          
      - name: ๐ฆ ุชุซุจูุช ููุชุจุงุช Google
        run: |
          python3 -m pip install --upgrade pip
          pip install google-api-python-client google-auth-httplib2 google-auth-oauthlib
          echo "โ ุชู ุชุซุจูุช ุงูููุชุจุงุช"
          
      - name: ๐ ุงุฎุชุจุงุฑ Secrets
        env:
          BLOG_ID: ${{ secrets.BLOG_ID }}
          CLIENT_SECRET_JSON: ${{ secrets.CLIENT_SECRET_JSON }}
        run: |
          echo "=== ุงุฎุชุจุงุฑ Secrets ==="
          
          if [ -z "$BLOG_ID" ]; then
            echo "โ BLOG_ID ููููุฏ"
          else
            echo "โ BLOG_ID ููุฌูุฏ"
          fi
          
          if [ -z "$CLIENT_SECRET_JSON" ]; then
            echo "โ CLIENT_SECRET_JSON ููููุฏ"
          else
            echo "โ CLIENT_SECRET_JSON ููุฌูุฏ"
            
            # ูุญุงููุฉ ูุฑุงุกุฉ JSON
            echo "$CLIENT_SECRET_JSON" | python3 -c "import json, sys; json.loads(sys.stdin.read()); print('โ JSON ุตุงูุญ')" 2>/dev/null || echo "โ๏ธ JSON ุบูุฑ ุตุงูุญ"
          fi
          
      - name: ๐ซ ูุฑุญูุฉ ุงููToken
        env:
          BLOG_ID: ${{ secrets.BLOG_ID }}
          CLIENT_SECRET_JSON: ${{ secrets.CLIENT_SECRET_JSON }}
          TOKEN_PICKLE: ${{ secrets.TOKEN_PICKLE }}
        run: |
          echo "=== ูุฑุญูุฉ ุงููToken ==="
          
          if [ -n "$TOKEN_PICKLE" ]; then
            echo "โ TOKEN_PICKLE ููุฌูุฏ"
            echo "๐ ุทูู ุงููToken: ${#TOKEN_PICKLE} ุญุฑู"
          else
            echo "๐ญ TOKEN_PICKLE ุบูุฑ ููุฌูุฏ (ุทุจูุนู ูู ุฃูู ุชุดุบูู)"
          fi
          
          # ุฅูุดุงุก ููู client_secret.json
          echo "$CLIENT_SECRET_JSON" > client.json
          echo "๐ ุชู ุฅูุดุงุก client.json"
          
      - name: ๐ ูุชูุฌุฉ ููุงุฆูุฉ
        run: |
          echo ""
          echo "๐ฏ **ุงูุฎุทูุฉ ุงูุชุงููุฉ:**"
          echo ""
          
          if [ -n "${{ secrets.BLOG_ID }}" ] && [ -n "${{ secrets.CLIENT_SECRET_JSON }}" ]; then
            if [ -z "${{ secrets.TOKEN_PICKLE }}" ]; then
              echo "1. โ ูุฏูู BLOG_ID ู CLIENT_SECRET_JSON"
              echo "2. ๐ ุงูุขู ุฃูุดุฆ workflow ูุฅูุดุงุก ุงููToken"
            else
              echo "1. โ ูุฏูู ูู ุงููSecrets ุงููุทููุจุฉ"
              echo "2. ๐ ุงูุขู ุฃูุดุฆ workflow ูููุดุฑ ุนูู ุจููุฌุฑ"
            fi
          else
            echo "โ ูุงุฒุงู ูููุตู ุจุนุถ ุงููSecrets"
            echo "   - BLOG_ID: ${{ secrets.BLOG_ID != '' && 'โ' || 'โ' }}"
            echo "   - CLIENT_SECRET_JSON: ${{ secrets.CLIENT_SECRET_JSON != '' && 'โ' || 'โ' }}"
          fi
